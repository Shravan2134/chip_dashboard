{% extends "core/base.html" %}

{% block title %}Settings Â· Broker Portal{% endblock %}
{% block page_title %}Settings{% endblock %}
{% block page_subtitle %}Configure system settings and weekly report schedules{% endblock %}

{% block content %}
<div style="background: var(--bg-content); border-radius: 8px; padding: 24px; border: 1px solid var(--border); max-width: 700px;">
    <form method="post">
        {% csrf_token %}
        
        <h2 style="font-size: 20px; font-weight: 600; margin-bottom: 16px;">Weekly Report Settings</h2>
        
        <div class="form-row">
            <label class="field-label">Weekly Report Day *</label>
            <select name="weekly_report_day" class="field-input" required>
                <option value="0" {% if settings.weekly_report_day == 0 %}selected{% endif %}>Monday</option>
                <option value="1" {% if settings.weekly_report_day == 1 %}selected{% endif %}>Tuesday</option>
                <option value="2" {% if settings.weekly_report_day == 2 %}selected{% endif %}>Wednesday</option>
                <option value="3" {% if settings.weekly_report_day == 3 %}selected{% endif %}>Thursday</option>
                <option value="4" {% if settings.weekly_report_day == 4 %}selected{% endif %}>Friday</option>
                <option value="5" {% if settings.weekly_report_day == 5 %}selected{% endif %}>Saturday</option>
                <option value="6" {% if settings.weekly_report_day == 6 %}selected{% endif %}>Sunday</option>
            </select>
            <div style="font-size: 12px; color: var(--muted); margin-top: 4px;">
                Choose the day of the week when weekly reports should be auto-generated.
            </div>
        </div>
        
        <div class="form-row">
            <label style="display: flex; align-items: center; gap: 8px;">
                <input type="checkbox" name="auto_generate_weekly_reports" {% if settings.auto_generate_weekly_reports %}checked{% endif %}>
                <span class="field-label" style="margin: 0;">Auto-generate Weekly Reports</span>
            </label>
            <div style="font-size: 12px; color: var(--muted); margin-top: 4px;">
                When enabled, weekly reports will be automatically generated on the selected day.
            </div>
        </div>
        
        <h2 style="font-size: 20px; font-weight: 600; margin-top: 32px; margin-bottom: 16px;">Profit/Loss Configuration</h2>
        
        <div class="form-row">
            <label class="field-label">Admin Profit Percentage (%) *</label>
            <input type="number" name="admin_profit_pct" class="field-input" step="0.01" min="0" max="100" value="{{ settings.admin_profit_pct }}" required>
            <div style="font-size: 12px; color: var(--muted); margin-top: 4px;">
                Percentage of client loss that admin earns as profit (e.g., 11% means admin gets 11% of client's loss).
            </div>
        </div>
        
        <div class="form-row">
            <label class="field-label">Admin Loss Percentage (%) *</label>
            <input type="number" name="admin_loss_pct" class="field-input" step="0.01" min="0" max="100" value="{{ settings.admin_loss_pct }}" required>
            <div style="font-size: 12px; color: var(--muted); margin-top: 4px;">
                Percentage of client profit that admin bears as loss (e.g., 10% means admin loses 10% of client's profit).
            </div>
        </div>
        
        <div class="form-row">
            <label class="field-label">Company Share on Admin Profit (%) *</label>
            <input type="number" name="company_share_on_profit_pct" class="field-input" step="0.01" min="0" max="100" value="{{ settings.company_share_on_profit_pct }}" required>
            <div style="font-size: 12px; color: var(--muted); margin-top: 4px;">
                Percentage of admin profit that company takes (e.g., 40% means company gets 40% of admin's profit).
            </div>
        </div>
        
        <div class="form-row">
            <label class="field-label">Company Share on Admin Loss (%) *</label>
            <input type="number" name="company_share_on_loss_pct" class="field-input" step="0.01" min="0" max="100" value="{{ settings.company_share_on_loss_pct }}" required>
            <div style="font-size: 12px; color: var(--muted); margin-top: 4px;">
                Percentage of admin loss that company shares (e.g., 50% means company shares 50% of admin's loss).
            </div>
        </div>
        
        <div style="display: flex; gap: 12px; margin-top: 24px;">
            <button type="submit" class="btn btn-primary">Save Settings</button>
            <a href="{% url 'dashboard' %}" class="btn">Cancel</a>
        </div>
    </form>
</div>

<div style="background: var(--bg-content); border-radius: 8px; padding: 20px; border: 1px solid var(--border); margin-top: 24px; max-width: 700px;">
    <h2 style="font-size: 20px; font-weight: 600; margin-bottom: 16px;">System Information</h2>
    <div style="font-size: 14px; color: var(--muted);">
        <p>Total Clients: {{ settings|length|default:0 }}</p>
        <p>Total Exchanges: {{ settings|length|default:0 }}</p>
        <p style="margin-top: 12px;">
            <a href="/admin/" class="btn btn-sm">Go to Admin Panel</a>
        </p>
    </div>
</div>
{% endblock %}

