{% extends "core/base.html" %}

{% block title %}Link Client to Exchange Â· Transaction Hub{% endblock %}
{% block page_title %}Link Client to Exchange{% endblock %}
{% block page_subtitle %}Configure client-exchange account with percentages{% endblock %}

{% block content %}
<div class="card" style="max-width: 500px;">
    {% if messages %}
        {% for message in messages %}
            <div style="padding: 12px 16px; border-radius: 8px; margin-bottom: 20px; {% if message.tags == 'success' %}background: #d1fae5; color: #065f46; border: 1px solid #10b981;{% elif message.tags == 'error' %}background: #fee2e2; color: #991b1b; border: 1px solid #dc2626;{% else %}background: #dbeafe; color: #1e40af; border: 1px solid #3b82f6;{% endif %}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    
    <form method="post">
        {% csrf_token %}
        
        <div class="form-row">
            <label class="field-label">Client *</label>
            <select name="client" class="field-input" required>
                <option value="">-- Select Client --</option>
                {% for client in clients %}
                    <option value="{{ client.pk }}" {% if selected_client_id|default:"" == client.pk|stringformat:"s" %}selected{% endif %}>{{ client.name }}{% if client.code %} ({{ client.code }}){% endif %}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-row">
            <label class="field-label">Exchange *</label>
            <select name="exchange" class="field-input" required>
                <option value="">-- Select Exchange --</option>
                {% for exchange in exchanges %}
                    <option value="{{ exchange.pk }}">{{ exchange.name }}{% if exchange.code %} ({{ exchange.code }}){% endif %}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-row">
            <label class="field-label">My Total % *</label>
            <input type="number" name="my_percentage" class="field-input" min="0" max="100" required>
        </div>
        
        <div style="border-top: 1px solid var(--border); margin: 20px 0; padding-top: 20px;">
            
            <div class="form-row">
                <label class="field-label">Friend % (Report Only)</label>
                <input type="number" name="friend_percentage" class="field-input" min="0" max="100" placeholder="Leave blank if not needed">
                <div style="font-size: 13px; color: var(--muted); margin-top: 4px;">
                    Friend/Student percentage. Must equal: My Total % - My Own %
                </div>
            </div>
            
            <div class="form-row">
                <label class="field-label">My Own % (Report Only)</label>
                <input type="number" name="my_own_percentage" class="field-input" min="0" max="100" placeholder="Leave blank if not needed">
                <div style="font-size: 13px; color: var(--muted); margin-top: 4px;">
                    Your own percentage. Friend % + My Own % must equal My Total %
                </div>
            </div>
        </div>
        
        <button type="submit" class="btn btn-primary mt-3">Link Client to Exchange</button>
        <a href="{% url 'exchange_list' %}" class="btn mt-3" style="margin-left: 8px;">Cancel</a>
    </form>
</div>
{% endblock %}
